import os
from typing import Optional

import google.generativeai as genai


class GeminiAPI:
    def __init__(self):
        api_key = os.getenv("GEMINI_API_KEY")
        if not api_key:
            raise RuntimeError(
                "GEMINI_API_KEY is not set. Please set it in your environment or .env file."
            )

        genai.configure(api_key=api_key)
        self.model = genai.GenerativeModel("gemini-1.5-flash")

        self.generation_config = {
            "temperature": 0.7,
            "top_p": 0.95,
            "top_k": 40,
            "max_output_tokens": 2048,
        }

    def generate_response(self, prompt: str) -> Optional[str]:
        response = self.model.generate_content(
            prompt,
            generation_config=self.generation_config,
        )
        return (response.text or "").strip() if hasattr(response, "text") else ""


